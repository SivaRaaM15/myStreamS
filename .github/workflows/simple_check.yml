name: Simple URL Check

on: [push, workflow_dispatch]

jobs:
  check-urls:
    runs-on: ubuntu-latest
    steps:
    - uses: actions/checkout@v4
    
    - name: Check M3U file
      run: |
        echo "üîç Checking M3U file..."
        
        # Check if file exists and has content
        if [ ! -f "sivarenu.m3u" ]; then
          echo "‚ùå sivarenu.m3u not found!"
          exit 1
        fi
        
        # Count URLs in the file
        URL_COUNT=$(grep -c "^http" sivarenu.m3u || true)
        echo "üìä Found $URL_COUNT stream URLs"
        
        # Count EXTINF entries
        STREAM_COUNT=$(grep -c "^#EXTINF" sivarenu.m3u || true)
        echo "üì∫ Found $STREAM_COUNT stream entries"
        
        # Show first few URLs as sample
        echo "üîó Sample URLs:"
        grep "^http" sivarenu.m3u | head -5
        
    - name: Install Python dependencies
      run: pip install requests
        
    - name: Quick URL validation
      run: |
        python3 -c "
import requests, re, sys
try:
    with open('sivarenu.m3u', 'r') as f:
        urls = re.findall(r'^https?://[^\s]+', f.read(), re.MULTILINE)
    
    print(f'Testing {min(3, len(urls))} sample URLs...')
    
    for url in urls[:3]:  # Test only first 3 to save time
        try:
            response = requests.head(url, timeout=5)
            print(f'‚úÖ {url[:60]}... - Status: {response.status_code}')
        except Exception as e:
            print(f'‚ùå {url[:60]}... - Error: {type(e).__name__}')
            
except Exception as e:
    print(f'Error: {e}')
    sys.exit(1)
        "
