name: Simple URL Check

on: [push, workflow_dispatch]

jobs:
  check-urls:
    runs-on: ubuntu-latest
    steps:
      - uses: actions/checkout@v4
      
      - name: Check M3U file and URLs
        run: |
          echo "üîç Checking M3U file..."
          
          if [ ! -f "sivarenu.m3u" ]; then
            echo "‚ùå sivarenu.m3u not found!"
            exit 1
          fi
          
          # Count URLs in the file
          URL_COUNT=$(grep -c "^http" sivarenu.m3u || true)
          echo "üìä Found $URL_COUNT stream URLs"
          
          # Count EXTINF entries
          STREAM_COUNT=$(grep -c "^#EXTINF" sivarenu.m3u || true)
          echo "üì∫ Found $STREAM_COUNT stream entries"
          
          # Show first few URLs as sample
          echo "üîó Sample URLs:"
          grep "^http" sivarenu.m3u | head -5
          
      - name: Basic URL validation with curl
        run: |
          echo "üåê Testing URL accessibility..."
          
          # Extract first 3 URLs and test with curl
          grep "^http" sivarenu.m3u | head -3 | while read url; do
            echo "Testing: $url"
            
            # Use curl to check if URL is accessible (with timeout)
            if curl --head --silent --fail --max-time 5 "$url" > /dev/null 2>&1; then
              echo "   ‚úÖ Accessible"
            else
              echo "   ‚ùå Not accessible or timeout"
            fi
          done
          
          echo "URL check completed!"
