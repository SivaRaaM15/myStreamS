- name: Quick URL validation (Non-failing)
  run: |
    python3 -c "
import requests, re, time
from urllib.parse import urlparse

print('ğŸ” Starting URL validation...')

try:
    with open('sivarenu.m3u', 'r') as f:
        content = f.read()
    
    urls = re.findall(r'^https?://[^\s]+', content, re.MULTILINE)
    print(f'ğŸ“Š Found {len(urls)} URLs in file')
    
    if not urls:
        print('â„¹ï¸ No URLs found to test')
        exit(0)
    
    print('Testing first 3 URLs (will not fail workflow):')
    
    for i, url in enumerate(urls[:3]):
        clean_url = url.strip()
        print(f'\nTesting URL {i+1}: {clean_url[:60]}...')
        
        try:
            # Use GET instead of HEAD with very short timeout
            response = requests.get(clean_url, timeout=3, stream=True, allow_redirects=True)
            print(f'   âœ… HTTP {response.status_code}')
            response.close()  # Important: close connection
        except requests.exceptions.Timeout:
            print(f'   â° Timeout (3s) - URL might be slow')
        except requests.exceptions.ConnectionError:
            print(f'   ğŸ”Œ Connection refused')
        except requests.exceptions.TooManyRedirects:
            print(f'   ğŸ”„ Too many redirects')
        except Exception as e:
            print(f'   âŒ {type(e).__name__}')
        
        time.sleep(1)  # Be nice to servers
    
    print('\nâœ… URL check completed (workflow continues regardless of results)')
    
except FileNotFoundError:
    print('âŒ sivarenu.m3u file not found in repository root')
except Exception as e:
    print(f'âŒ Script error: {e}')
"
